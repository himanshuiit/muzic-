{"version":3,"sources":["../../server/routes/updateFav.js"],"names":["router","Router","post","req","resp","userId","body","user_id","key","trackName","track_name","response","queryString","query","error","res","ress","code","message","send","result","console","log","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;;;AAFA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;;;AAIAD,OAAOE,IAAP,CAAY,iBAAZ,EAA+B,UAASC,GAAT,EAAcC,IAAd,EAAoB;AAClD;AACA,KAAIC,SAASF,IAAIG,IAAJ,CAASC,OAAtB;AACA,KAAIC,MAAML,IAAIG,IAAJ,CAASE,GAAnB,CAHkD,CAG1B;AACxB,KAAIC,YAAYN,IAAIG,IAAJ,CAASI,UAAzB;;AAEA,KAAIC,WAAW;AACd,UAAQ,GADM;AAEd,aAAW;AAFG,EAAf;;AAKA,KAAIH,OAAO,CAAC,CAAZ,EAAe;AACf;AAAE;AACD,OAAII,cAAc,wEAAlB;;AAEA,gBAAWC,KAAX,CAAiBD,WAAjB,EAA8B,CAACP,MAAD,EAASI,SAAT,CAA9B,EAAmD,UAASK,KAAT,EAAgBC,GAAhB,EAAqB;AACvE;AACA;AACA;AACA,QAAID,KAAJ,EAAW;AACV,kBAAWD,KAAX,CAAiB,yDAAjB,EAA4E,CAACR,MAAD,EAASI,SAAT,CAA5E,EAAiG,UAASK,KAAT,EAAgBE,IAAhB,EAAsB;AACtH,UAAI,CAACF,KAAL,EAAY;AACX;AACAH,gBAASM,IAAT,GAAgB,GAAhB;AACAN,gBAASO,OAAT,GAAmB,oBAAnB;AACAd,YAAKe,IAAL,CAAUR,QAAV;AACA;AAED,MARD;AAUA,KAXD,MAWO;AACN;AACAA,cAASM,IAAT,GAAgB,GAAhB;AACAN,cAASO,OAAT,GAAmB,eAAnB;AACAd,UAAKe,IAAL,CAAUR,QAAV;AACA;AAGD,IAvBD;AAyBA;AACD;AA9BA,MA+BK,IAAIH,OAAO,CAAX,EAAc;;AAElB,gBAAWK,KAAX,CAAiB,+DAAjB,EAAiF,CAACJ,SAAD,CAAjF,EAA8F,UAASK,KAAT,EAAgBM,MAAhB,EAAwB;AACrH,QAAIN,KAAJ,EAAW;AACV;AACA;AACAH,cAASM,IAAT,GAAgB,GAAhB;AACAN,cAASO,OAAT,GAAmB,8BAAnB;AACAd,UAAKe,IAAL,CAAUR,QAAV;AACA,KAND,MAMO;AACNA,cAASM,IAAT,GAAgB,GAAhB;AACAN,cAASO,OAAT,GAAmB,sBAAnB;AACAd,UAAKe,IAAL,CAAUR,QAAV;AACA;AACDU,YAAQC,GAAR,CAAY,qBAAZ;AAEA,IAdD;AAeA;AACD;AAEA,CA9DD;AA+DAC,OAAOC,OAAP,GAAiBxB,MAAjB","file":"updateFav.js","sourcesContent":["import express from 'express';\r\nimport mysql from 'mysql';\r\nconst router = express.Router();\r\nimport isAuth from '../middle/isAuth.js'\r\nimport connection from '../db.js';\r\n\r\nrouter.post('/user/updateFav', function(req, resp) {\r\n\t//console.log(req);\r\n\tlet userId = req.body.user_id;\r\n\tlet key = req.body.key; // to add to fav list , or to remove from the fav list. key =1 remove from fav key =-1 add to fav;\r\n\tlet trackName = req.body.track_name;\r\n\r\n\tlet response = {\r\n\t\t\"code\": 404,\r\n\t\t\"message\": \"some error occured  \"\r\n\t};\r\n\r\n\tif (key == -1) // i am adding into the favorite user\r\n\t{ //'AND track_name ='+trackName,\r\n\t\tvar queryString = 'SELECT track_name FROM track_user WHERE user_id = ? AND track_name = ?';\r\n\r\n\t\tconnection.query(queryString, [userId, trackName], function(error, res) {\r\n\t\t\t//  console.log('error',error);x\r\n\t\t\t//console.log(\"hi this is inside the query\");\r\n\t\t\t//  console.log(error);\r\n\t\t\tif (error) {\r\n\t\t\t\tconnection.query('Insert into track_user(user_id, track_name) values(?,?)', [userId, trackName], function(error, ress) {\r\n\t\t\t\t\tif (!error) {\r\n\t\t\t\t\t\t//  console.log(\"we are in in\");\r\n\t\t\t\t\t\tresponse.code = 200;\r\n\t\t\t\t\t\tresponse.message = \"added successfully\";\r\n\t\t\t\t\t\tresp.send(response);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t} else {\r\n\t\t\t\t//   console.log(\"in else\");\r\n\t\t\t\tresponse.code = 200;\r\n\t\t\t\tresponse.message = \"already added\";\r\n\t\t\t\tresp.send(response);\r\n\t\t\t}\r\n\r\n\r\n\t\t});\r\n\r\n\t}\r\n\t////////////////////////////////////////////////////// we now remove the track from the user favorite /////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\telse if (key == 1) {\r\n\r\n\t\tconnection.query('DELETE FROM track_user WHERE user_id=userId AND track_name =?',[trackName], function(error, result) {\r\n\t\t\tif (error) {\r\n\t\t\t\t//  console.log(\"hello you are in error zone\");\r\n\t\t\t\t//  console.log(response.code);\r\n\t\t\t\tresponse.code = 402;\r\n\t\t\t\tresponse.message = \"some error occure in delete.\";\r\n\t\t\t\tresp.send(response);\r\n\t\t\t} else {\r\n\t\t\t\tresponse.code = 200;\r\n\t\t\t\tresponse.message = \"deleted successfully\";\r\n\t\t\t\tresp.send(response);\r\n\t\t\t}\r\n\t\t\tconsole.log('sending the message');\r\n\r\n\t\t});\r\n\t}\r\n\t//  console.log('sending response');\r\n\r\n});\r\nmodule.exports = router;\r\n"]}